pub mod carbonara;
use crate::connection::ConnectionType;

pub enum BootStage {
    Brom,
    Preloader,
    Da1,
    Da2,
}

pub struct ExploitMeta {
    pub name: String,
    pub boot_mode: Vec<ConnectionType>, // In which mode the exploit works (BROM, Preloader, DA)
    pub boot_stage: BootStage, // In which stage the exploit works. (e.g. Kamakiri runs in BROM, Carbonara in DA1)
}

pub trait Exploit {
    fn run(&mut self) -> Result<bool, String>;

    fn get_meta(&self) -> &ExploitMeta;
}
